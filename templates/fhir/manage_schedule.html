{% extends 'fhir/doctor.html' %}
{% block function %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/fhir/schedule.css' %}">
    <div class="schedule">
        {% comment %}
        <div class="container">
            <div class="search-bar">
                <input type="text" id="search" onkeyup="onPageSearch()" placeholder="Tìm kiếm">
            </div>
            <div class="container-header">
                <table style="width: 100%;"> 
                    <tr class="column-header">
                        <td style="width:50px;"></td>
                        <td style="width: 10px;"></td>
                        <td>
                            <table class="column-header-container">
                                <tbody>
                                    <tr class="header-data">
                                        <td>
                                            <p>Thứ Hai</p>
                                            <p>{{days_of_week.Monday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Ba</p>
                                            <p>{{days_of_week.Tuesday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Tư</p>
                                            <p>{{days_of_week.Wednesday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Năm</p>
                                            <p>{{days_of_week.Thursday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Sáu</p>
                                            <p>{{days_of_week.Friday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Bảy</p>
                                            <p>{{days_of_week.Saturday|date:'d-m-Y'}}</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                        <td style="width: 17px;"></td>
                    </tr>
                </table>
            </div>
            <div class="container-body" id="container-body" onclick="changeDisplay('form-container')">
                <table style="width: 100%;">
                    <tbody>             
                            <tr>
                                <td class="row-header">
                                    <table class="row-header-container">
                                        <tbody>
                                            <tr>
                                                <td>01:00</td>
                                            </tr>
                                            <tr>
                                                <td>02:00</td>
                                            </tr>
                                            <tr>
                                                <td>03:00</td>
                                            </tr>
                                            <tr>
                                                <td>04:00</td>
                                            </tr>
                                            <tr>
                                                <td>05:00</td>
                                            </tr>
                                            <tr>
                                                <td>06:00</td>
                                            </tr>
                                            <tr>
                                                <td>07:00</td>
                                            </tr>
                                            <tr>
                                                <td>08:00</td>
                                            </tr>
                                            <tr>
                                                <td>09:00</td>
                                            </tr>
                                            <tr>
                                                <td>10:00</td>
                                            </tr>
                                            <tr>
                                                <td>11:00</td>
                                            </tr>
                                            <tr>
                                                <td>12:00</td>
                                            </tr>
                                            <tr>
                                                <td>13:00</td>
                                            </tr>
                                            <tr>
                                                <td>14:00</td>
                                            </tr>
                                            <tr>
                                                <td>15:00</td>
                                            </tr>
                                            <tr>
                                                <td>16:00</td>
                                            </tr>
                                            <tr>
                                                <td>17:00</td>
                                            </tr>
                                            <tr>
                                                <td>18:00</td>
                                            </tr>
                                            <tr>
                                                <td>19:00</td>
                                            </tr>
                                            <tr>
                                                <td>20:00</td>
                                            </tr>
                                            <tr>
                                                <td>21:00</td>
                                            </tr>
                                            <tr>
                                                <td>22:00</td>
                                            </tr>
                                            <tr>
                                                <td>23:00</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <td class="line">
                                    <table style="width: 10px;">
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                    </table>
                                </td>
                                <td class="table-data">
                                    <table class="data-container">
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                    </tbody>
                </table>
            </div>  
        </div>
        {% endcomment %}
       
            {% csrf_token %}
            <div class="waiting-list">
                <h2>DANH SÁCH CHỜ</h2>
                
                {% if encounters %}
                    <ul>
                        {% for encounter in encounters %}
                        <li>{{encounter.patient.name}} - {{encounter.patient.identifier}}</li>
                        {% endfor %}
                    </ul>
                    <div class="form-container" id="form-container" style="display: none;">
                        <form action="" method="post">
                        {% csrf_token %}
                        <div class="form-header">
                            <i class="fas fa-grip-lines"></i>
                            <i onclick="closeForm('form-container')" class="fas fa-times"></i>
                        </div>                        
                        <div class="form-body">
                            <p id="confirmation-text">Chọn bệnh nhân muốn chỉ định</p>
                            {% for encounter in encounters %}
                            <input type="radio" name="encounter" id="{{encounter.encounter_identifier}}" value="{{encounter.encounter_identifier}}" required> 
                            <label for="{{encounter.encounter_identifier}}">{{encounter.patient.name}} - {{encounter.patient.identifier}}</label>
                            {% endfor %}
                            <input type="hidden" name="practitioner" id="practitioner_input" value="">
                            <input type="hidden" name="schedule_date" id="schedule_date_input" value="">
                            <input type="hidden" name="session" id="session_input">
                            <div style="text-align: center;">
                                <button type="submit" class="btn">Xác nhận</button>
                            </div>
                        </div>
                        </form>
                    </div>
                {% else %}
                    <p><b>Không có bệnh nhân chờ</b></p>
                {% endif %}
            </div>
            <div>
                <form action="" method="get">
                    <label for="id_department_schedule">Chọn Khoa</label>
                    <input list="department_list" name="department_schedule" id="id_department_schedule">
                    <datalist id="department_list">
                        {% for department in departments %}
                            <option value="{{department}}">{{department}}</option>
                        {% endfor %}
                    </datalist>
                    <button type="submit" class="btn">Lọc</button>
                </form>
            </div>
            <div class="container">
                <div class="container-header">
                    <table style="width: 100%;"> 
                        <tr class="column-header">
                            
                            <td>
                                <table class="column-header-container">
                                    <tbody>
                                        <tr class="header-data">
                                            <td style="width:55px;"></td>
                                            <td>
                                                <p>Thứ Hai</p>
                                                <p>{{days_of_week.Monday.date|date:'d-m-Y'}}</p>
                                            </td>
                                            <td>
                                                <p>Thứ Ba</p>
                                                <p>{{days_of_week.Tuesday.date|date:'d-m-Y'}}</p>
                                            </td>
                                            <td>
                                                <p>Thứ Tư</p>
                                                <p>{{days_of_week.Wednesday.date|date:'d-m-Y'}}</p>
                                            </td>
                                            <td>
                                                <p>Thứ Năm</p>
                                                <p>{{days_of_week.Thursday.date|date:'d-m-Y'}}</p>
                                            </td>
                                            <td>
                                                <p>Thứ Sáu</p>
                                                <p>{{days_of_week.Friday.date|date:'d-m-Y'}}</p>
                                            </td>
                                            <td>
                                                <p>Thứ Bảy</p>
                                                <p>{{days_of_week.Saturday.date|date:'d-m-Y'}}</p>
                                            </td>
                                            <td style="width: 17px;"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </td>    
                        </tr>
                    </table>
                </div>
                <div class="container-body" id="container-body">
                    <table style="width: 100%;">
                        <tbody>             
                                <tr>
                                    <td class="row-header">
                                        <table class="row-header-container">
                                            <tbody>
                                                <tr>
                                                    <td>Sáng</td>
                                                </tr>
                                                <tr>
                                                    <td>Chiều</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                    <td class="table-data">
                                        <table class="data-container">
                                            <tr>
                                                <td {% if days_of_week.Monday.is_future %}{% if schedule_dates.Monday.morning %}class="available-time"{% else %}class="not-available-time"{% endif %} {% endif %}>
                                                    {% if schedule_dates.Monday.morning %}
                                                        {% for date in schedule_dates.Monday.morning %}
                                                        <div id="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-mon-morn" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-mon-morn', 'data-{{date.practitioner_identifier.identifier}}-mon-morn')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-mon-morn" style="display: none; ">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Monday.morning|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Monday.is_future %}
                                                            {% with days_of_week.Monday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'morning')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}
                                                </td>
                                                <td {% if days_of_week.Tuesday.is_future %}{% if schedule_dates.Tuesday.morning %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Tuesday.morning %}
                                                        {% for date in schedule_dates.Tuesday.morning %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-tues-mon" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-tues-mon', 'data-{{date.practitioner_identifier.identifier}}-tues-mon')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-tues-mon" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Tuesday.morning|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Tuesday.is_future %}
                                                            {% with days_of_week.Tuesday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'morning')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                            
                                                </td>
                                                <td {% if days_of_week.Wednesday.is_future %}{% if schedule_dates.Wednesday.morning %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Wednesday.morning %}
                                                        {% for date in schedule_dates.Wednesday.morning %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-wed-morn" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-wed-morn', 'data-{{date.practitioner_identifier.identifier}}-wed-morn')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-wed-morn" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Wednesday.morning|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Wednesday.is_future %}
                                                            {% with days_of_week.Wednesday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'morning')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                               
                                                </td>
                                                <td {% if days_of_week.Thursday.is_future %}{% if schedule_dates.Thursday.morning %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Thursday.morning %}
                                                        {% for date in schedule_dates.Thursday.morning %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-thurs-morn" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-thurs-morn', 'data-{{date.practitioner_identifier.identifier}}-thurs-morn')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-thurs-morn" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Thursday.morning|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Thursday.is_future %}
                                                            {% with days_of_week.Thursday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'morning')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                              
                                                </td>
                                                <td {% if days_of_week.Friday.is_future %}{% if schedule_dates.Friday.morning %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Friday.morning %}
                                                        {% for date in schedule_dates.Friday.morning %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-fri-morn" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-fri-morn', 'data-{{date.practitioner_identifier.identifier}}-fri-morn')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-fri-morn" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Friday.morning|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Friday.is_future %}
                                                            {% with days_of_week.Friday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'morning')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                              
                                                </td>
                                                <td {% if days_of_week.Saturday.is_future %}{% if schedule_dates.Saturday.morning %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Saturday.morning %}
                                                        {% for date in schedule_dates.Saturday.morning %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-sat-morn" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-sat-morn', 'data-{{date.practitioner_identifier.identifier}}-sat-morn')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-sat-morn" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Saturday.morning|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Saturday.is_future %}
                                                            {% with days_of_week.Saturday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'morning')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                              
                                                </td>
                                            </tr>
                                            <tr>
                                                <td {% if days_of_week.Monday.is_future %}{% if schedule_dates.Monday.afternoon %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Monday.afternoon %}
                                                        {% for date in schedule_dates.Monday.afternoon %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-mon-noon" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-mon-noon', 'data-{{date.practitioner_identifier.identifier}}-mon-noon')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-mon-noon" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Monday.afternoon|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Monday.is_future %}
                                                            {% with days_of_week.Monday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'afternoon')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                              
                                                </td>
                                                <td {% if days_of_week.Tuesday.is_future %}{% if schedule_dates.Tuesday.afternoon %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Tuesday.afternoon %}
                                                        {% for date in schedule_dates.Tuesday.afternoon %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-tues-noon" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-tues-noon', 'data-{{date.practitioner_identifier.identifier}}-tues-noon')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-tues-noon" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Tuesday.afternoon|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Tuesday.is_future %}
                                                            {% with days_of_week.Tuesday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'afternoon')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                                                                           
                                                </td>
                                                <td {% if days_of_week.Wednesday.is_future %}{% if schedule_dates.Wednesday.afternoon %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Wednesday.afternoon %}
                                                        {% for date in schedule_dates.Wednesday.afternoon %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-wed-noon" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-wed-noon', 'data-{{date.practitioner_identifier.identifier}}-wed-noon')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-wed-noon" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Wednesday.afternoon|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Wednesday.is_future %}
                                                            {% with days_of_week.Wednesday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'afternoon')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                                                                          
                                                </td>
                                                <td {% if days_of_week.Thursday.is_future %}{% if schedule_dates.Thursday.afternoon %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Thursday.afternoon %}
                                                        {% for date in schedule_dates.Thursday.afternoon %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-thurs-noon" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-thurs-noon', 'data-{{date.practitioner_identifier.identifier}}-thurs-noon')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-thurs-noon" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Thursday.afternoon|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Thursday.is_future %}
                                                            {% with days_of_week.Thursday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'afternoon')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                                                                          
                                                </td>
                                                <td {% if days_of_week.Friday.is_future %}{% if schedule_dates.Friday.afternoon %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Friday.afternoon %}
                                                        {% for date in schedule_dates.Friday.afternoon %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-fri-noon" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-fri-noon', 'data-{{date.practitioner_identifier.identifier}}-fri-noon')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-fri-noon" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Friday.afternoon|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Friday.is_future %}
                                                            {% with days_of_week.Friday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'afternoon')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                                                                           
                                                </td>
                                                <td {% if days_of_week.Saturday.is_future %}{% if schedule_dates.Saturday.afternoon %}class="available-time"{% else %}class="not-available-time"{% endif %}{% endif %}>
                                                    {% if schedule_dates.Saturday.afternoon %}
                                                        {% for date in schedule_dates.Saturday.afternoon %}
                                                        <div class="container">
                                                            
                                                            <p><i id="icon-{{date.practitioner_identifier.identifier}}-sat-noon" class="fa fa-arrow-right" onclick="rotateArrow('icon-{{date.practitioner_identifier.identifier}}-sat-noon', 'data-{{date.practitioner_identifier.identifier}}-sat-noon')"></i> {{date.practitioner_name}} - {{date.practitioner_identifier.identifier}}</p>
                                                            <div id="data-{{date.practitioner_identifier.identifier}}-sat-noon" style="display: none;">
                                                                <ul>
                                                                {% for encounter in assigned_encounters.Saturday.afternoon|get_item:date.practitioner_identifier.identifier %}
                                                                <li>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}}</li> 
                                                                {% endfor %}
                                                                </ul>
                                                            </div>
                                                            {% if days_of_week.Saturday.is_future %}
                                                            {% with days_of_week.Saturday.date|date:'Y-m-d' as date_to_submit %}
                                                            <button onclick="appendData('{{date.practitioner_identifier.identifier}}', '{{date_to_submit}}', 'afternoon')" class="btn">Chỉ định</button>
                                                            {% endwith %}
                                                            {% endif %}
                                                        </div>
                                                        {% endfor %}                                              
                                                    {% endif %}                                                                                          
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                        </tbody>
                    </table>
                </div>  
            </div>     
     
    </div>

    <script>
        function changeDisplay(elementId,weekDay, sessionValue){
            element = document.getElementById(elementId);
            dayElement = document.getElementById("day_of_work");
            sessionElement = document.getElementById("session");
            startTime = document.getElementById("start_time");
            endTime = document.getElementById("end_time");
            if (element.style.display == "none"){
                element.style.display = "flex";
                dayElement.value = weekDay;
                sessionElement.value = sessionValue;
                if (sessionValue == "morning"){
                    startTime.setAttribute("min", "07:00");
                    startTime.setAttribute("max", "12:00");
                    endTime.setAttribute("min", "07:00");
                    endTime.setAttribute("max", "12:00");
                    startTime.value = "07:00";
                    endTime.value = "12:00";
                }else if (sessionValue == "afternoon"){
                    startTime.setAttribute("min", "13:00");
                    startTime.setAttribute("max", "17:00");
                    endTime.setAttribute("min", "13:00");
                    endTime.setAttribute("max", "17:00");
                    startTime.value = "13:00";
                    endTime.value = "17:00";
                }
            }
            else {
                element.style.display = "none";
            }
        }
        var watchClickOnMeElement = document.getElementById('form-container');
    
        document.addEventListener('click', function(event) {
            if (event.target == watchClickOnMeElement) {
                watchClickOnMeElement.style.display = "none";
        }
        });

        
        function setMinMax(){
            var session = document.getElementById("session");
            var start = document.getElementById("start_time");
            var end = document.getElementById("end_time");
            if (session.options[session.selectedIndex].value == "morning"){
                start.setAttribute("min", "07:00");
                start.setAttribute("max", "12:00");
                end.setAttribute("min", "07:00");
                end.setAttribute("max", "12:00");
                start.value="07:00";
                end.value="12:00";
            }else if (session.options[session.selectedIndex].value == "afternoon"){
                start.setAttribute("min", "13:00");
                start.setAttribute("max", "17:00");
                end.setAttribute("min", "13:00");
                end.setAttribute("max", "17:00");
                start.value="13:00";
                end.value="17:00";
            }
        }
        function timeCheck(){
            start = document.getElementById("start_time");
            console.log(start.value);
            end = document.getElementById("end_time");
            console.log(end.value);
        }
        var div = document.getElementById('container');
        var icon = document.getElementById('icon');
        var open = false;
        
        function rotateArrow(arrowId, dataId){
            arrow = document.getElementById(arrowId);
            data = document.getElementById(dataId);
            console.log(data.style.display);
            if(arrow.className.includes('open')){
                arrow.className = 'fa fa-arrow-right';  
                data.style.display = 'none';
            } else{
                arrow.className = 'fa fa-arrow-right open';
                data.style.display = 'block';
            }
            
        }


        function appendData(practitioner, scheduleDate, session){
            practitionerInput = document.getElementById('practitioner_input');
            scheduleDateInput = document.getElementById('schedule_date_input');
            sessionInput = document.getElementById('session_input');
            formToSubmit = document.getElementById('form-container');
            console.log(practitioner)
            if (formToSubmit.style.display == "none"){
                confirmationText = document.getElementById('confirmation-text');
                practitionerInput.value = practitioner;
                scheduleDateInput.value = scheduleDate;
                sessionInput.value = session;
                formToSubmit.style.display = "flex";
            }
            else {
                formToSubmit.style.display = "none";
            }
        }
        function closeForm(formId){
            form = document.getElementById(formId);
            form.style.display = "none";
        }
    </script>
{% endblock %}