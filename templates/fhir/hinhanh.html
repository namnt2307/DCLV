{%extends 'fhir/base.html'%}
{%block url1%}'{%url 'fhir:hanhchinh'  data.Patient.identifier data.Encounter.identifier%}'{%endblock%}
{%block url2%}'{%url 'fhir:dangky'  data.Patient.identifier data.Encounter.identifier%}'{%endblock%}
{%block url3%}'{%url 'fhir:hoibenh'  data.Patient.identifier data.Encounter.identifier%}'{%endblock%}
{%block url5%}'{%url 'fhir:xetnghiem'  data.Patient.identifier data.Encounter.identifier%}'{%endblock%}
{%block url4%}'{%url 'fhir:toanthan'  data.Patient.identifier data.Encounter.identifier%}'{%endblock%}
{%comment%}{%block url8%}'{%url 'fhir:thuthuat'  data.Patient.identifier data.Encounter.identifier%}'{%endblock%}{%endcomment%}{%block url7%}'{%url 'fhir:thuoc'  data.Patient.identifier data.Encounter.identifier %}'{%endblock%}
{%block url6%}'{%url 'fhir:hinhanh'  data.Patient.identifier data.Encounter.identifier %}'{%endblock%}
{%block leftbar%}
{%endblock%}
{%block function%}
{% load widget_tweaks %}
<h1>CÁC THỦ THUẬT XỬ LÍ HÌNH ẢNH</h1>
<table>
    <thead>
        <th class="cell-data-10">ID thủ thuật</th>
        <th class="cell-data-10">Tên thủ thuật</th>
        <th class="cell-data-10">Tình trạng thủ thuật</th>
        <th class="cell-data-10">Ngày dự kiến thực hiện</th>
        <th class="cell-data-10">Ngày yêu cầu</th>
        <th class="cell-data-10">Bác sĩ yêu cầu</th>
        <th class="cell-data-10">Ghi chú</th>
        <th class="cell-data-10">Chi tiết</th>
        <th class="cell-data-10">Kết quả hình ảnh</th>
        <th class="cell-data-10">Chẩn đoán</th>
        {% if services %}
        <th></th>
        {% endif %}
    </thead>
    <tbody>
    {% if services %}
        {% for service in services %}
        <tr>
            <td class="cell-data-10">{{service.service_identifier}}</td>
            <td class="cell-data-10">{{service.service_code}}</td>
            <td class="cell-data-10">{{service.get_service_status_display}}</td>
            <td class="cell-data-10">{{service.service_occurrence|date:"d-m-Y"}}</td>
            <td class="cell-data-10">{{service.service_authored|date:"d-m-Y"}}</td>
            <td class="cell-data-10">{{service.service_requester}}</td>
            <td class="cell-data-10">{{service.service_note}}</td>
            <td class="cell-data-10"><a href="{%url 'fhir:chitiethinhanh'  data.Patient.identifier data.Encounter.identifier service.service_identifier%}">test</a></td>
            <td class="cell-data-10"></td>
            {%comment%}<td><a href="{%url 'fhir:ketquahinhanh'  data.Patient.identifier data.Encounter.identifier service.service_identifier %}"></a></td>{%endcomment%}
            <td class="cell-data-10"><a href="{%url 'fhir:chandoan'  data.Patient.identifier data.Encounter.identifier service.service_identifier %}">Chẩn đoán</a></td>
            <td>
                <form action="{% url 'fhir:delete' %}" method="POST">
                    {%csrf_token%}
                    <input type="hidden" name="_method" value="delete">
                    <input type="hidden" name="resource_type" id="" value="service_request">
                    <input type="hidden" name="url_next" value="{{request.get_full_path}}">
                    <input type="hidden" name="resource_identifier" value="{{service.service_identifier}}">
                    <button type="submit" class="btn cancel">Xóa</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    {% endif %}
</tbody>
    <div>
        <div class="formPopup" id="serviceForm">
            <div class="formContainer">
                <form action="" method="POST">
                    {%csrf_token%}
                    <div class="flex_container">
                        <label class="title">Tên xét nghiệm:</label>
                       {{service_form.service_code|add_class:"value"}}
                    </div>
                    <br>
                    <div class="flex_container">
                        <label class="title">Ngày dự kiến thực hiện:</label>
                        {{service_form.service_code|add_class:"value"}}
                    </div>
                    <br>
                    <div class="flex_container">
                        <label class="title">Ghi chú thêm:</label>
                        {{service_form.service_code|add_class:"value"}}
                    </div>
                    <br>
                    <button type="submit" class="btn">Thêm</button>
                    <button type="button" class="btn cancel" onclick="closeForm('serviceForm')">Xóa</button>
                </form>
            </div>
        </div>
    </div>
    {% if services %}
    <tr>
        <td colspan="11"><button class="float-left submit-button btn" onclick="openForm('serviceForm')">Thêm xét nghiệm</button></td>
    </tr>
    {%else%}
    <tr>
        <td colspan="10"><button class="float-left submit-button btn" onclick="openForm('serviceForm')">Thêm xét nghiệm</button></td>
    </tr>
    {%endif%}
</table>
{%endblock%}