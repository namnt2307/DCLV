{% extends 'fhir/doctor.html' %}
{% block function %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/fhir/schedule.css' %}">
{% for date in schedule_dates %}
    {{date.start_time|time:'H'}}
    {% if date.start_time|time:'H'|add:'0' == 0 %}
        {{date.start_time}}
    {% endif %}
    {{date.end_time|time:'H'}}
{% endfor %}
    <div class="schedule">
        {% comment %}
        <div class="container">
            <div class="search-bar">
                <input type="text" id="search" onkeyup="onPageSearch()" placeholder="Tìm kiếm">
            </div
            <div class="container-header">
                <table style="width: 100%;"> 
                    <tr class="column-header">
                        <td style="width:50px;"></td>
                        <td style="width: 10px;"></td>
                        <td>
                            <table class="column-header-container">
                                <tbody>
                                    <tr class="header-data">
                                        <td>
                                            <p>Thứ Hai</p>
                                            <p>{{days_of_week.Monday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Ba</p>
                                            <p>{{days_of_week.Tuesday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Tư</p>
                                            <p>{{days_of_week.Wednesday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Năm</p>
                                            <p>{{days_of_week.Thursday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Sáu</p>
                                            <p>{{days_of_week.Friday|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Bảy</p>
                                            <p>{{days_of_week.Saturday|date:'d-m-Y'}}</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>
                        <td style="width: 17px;"></td>
                    </tr>
                </table>
            </div>
            <div class="container-body" id="container-body" onclick="changeDisplay('form-container')">
                <table style="width: 100%;">
                    <tbody>             
                            <tr>
                                <td class="row-header">
                                    <table class="row-header-container">
                                        <tbody>
                                            <tr>
                                                <td>01:00</td>
                                            </tr>
                                            <tr>
                                                <td>02:00</td>
                                            </tr>
                                            <tr>
                                                <td>03:00</td>
                                            </tr>
                                            <tr>
                                                <td>04:00</td>
                                            </tr>
                                            <tr>
                                                <td>05:00</td>
                                            </tr>
                                            <tr>
                                                <td>06:00</td>
                                            </tr>
                                            <tr>
                                                <td>07:00</td>
                                            </tr>
                                            <tr>
                                                <td>08:00</td>
                                            </tr>
                                            <tr>
                                                <td>09:00</td>
                                            </tr>
                                            <tr>
                                                <td>10:00</td>
                                            </tr>
                                            <tr>
                                                <td>11:00</td>
                                            </tr>
                                            <tr>
                                                <td>12:00</td>
                                            </tr>
                                            <tr>
                                                <td>13:00</td>
                                            </tr>
                                            <tr>
                                                <td>14:00</td>
                                            </tr>
                                            <tr>
                                                <td>15:00</td>
                                            </tr>
                                            <tr>
                                                <td>16:00</td>
                                            </tr>
                                            <tr>
                                                <td>17:00</td>
                                            </tr>
                                            <tr>
                                                <td>18:00</td>
                                            </tr>
                                            <tr>
                                                <td>19:00</td>
                                            </tr>
                                            <tr>
                                                <td>20:00</td>
                                            </tr>
                                            <tr>
                                                <td>21:00</td>
                                            </tr>
                                            <tr>
                                                <td>22:00</td>
                                            </tr>
                                            <tr>
                                                <td>23:00</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <td class="line">
                                    <table style="width: 10px;">
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: solid white 0.1px"></td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: solid white 0.1px"></td>
                                        </tr>
                                    </table>
                                </td>
                                <td class="table-data">
                                    <table class="data-container">
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                    </tbody>
                </table>
            </div>  
        </div>
        {% endcomment %}
        <div class="container">
            <div class="container-header">
                <table style="width: 100%;"> 
                    <tr class="column-header">                        
                        <td>
                            <table class="column-header-container">
                                <tbody>
                                    <tr class="header-data">
                                        <td style="width:55px;"></td>
                                        <td>
                                            <p>Thứ Hai</p>
                                            <p>{{days_of_week.Monday.date|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Ba</p>
                                            <p>{{days_of_week.Tuesday.date|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Tư</p>
                                            <p>{{days_of_week.Wednesday.date|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Năm</p>
                                            <p>{{days_of_week.Thursday.date|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Sáu</p>
                                            <p>{{days_of_week.Friday.date|date:'d-m-Y'}}</p>
                                        </td>
                                        <td>
                                            <p>Thứ Bảy</p>
                                            <p>{{days_of_week.Saturday.date|date:'d-m-Y'}}</p>
                                        </td>
                                        <td style="width: 17px;"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </td>  
                    </tr>
                </table>
            </div>
            <div class="container-body" id="container-body">
                <table style="width: 100%;">
                    <tbody>             
                            <tr>
                                <td class="row-header">
                                    <table class="row-header-container">
                                        <tbody>
                                            <tr>
                                                <td>Sáng</td>
                                            </tr>
                                            <tr>
                                                <td>Chiều</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </td>
                                <td class="table-data">
                                    <table class="data-container">
                                        <tr>
                                            {% with days_of_week.Monday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Monday.is_future %}{% if schedule_dates.Monday.morning %}class="available-time" {% if not assigned_encounters.Monday.morning and not in_progress_encounters.Monday.morning %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'morning')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '0', 'morning')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Monday.morning %}                                                
                                                    {% if in_progress_encounters.Monday.morning %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Monday.morning %}
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Monday.morning %}
                                                        {% for encounter in assigned_encounters.Monday.morning %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Tuesday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Tuesday.is_future %}{% if schedule_dates.Tuesday.morning %}class="available-time" {% if not assigned_encounters.Tuesday.morning and not in_progress_encounters.Tuesday.morning %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'morning')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '1', 'morning')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Tuesday.morning %}
                                                    {% if in_progress_encounters.Tuesday.morning %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Tuesday.morning %}
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Tuesday.morning %}
                                                        {% for encounter in assigned_encounters.Tuesday.morning %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                    
                                                {% endif %}                                                
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Wednesday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Wednesday.is_future %}{% if schedule_dates.Wednesday.morning %}class="available-time" {% if not assigned_encounters.Wednesday.morning and not in_progress_encounters.Wednesday.morning %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'morning')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '2', 'morning')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Wednesday.morning %}                                    
                                                    {% if in_progress_encounters.Wednesday.morning %}
                                                        <p>Danh sách bệnh nhân</p>                                                                                                                
                                                        {% for encounter in in_progress_encounters.Wednesday.morning %}
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Wednesday.morning %}
                                                        {% for encounter in assigned_encounters.Wednesday.morning %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                    
                                                {% endif %}                                                
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Thursday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Thursday.is_future %}{% if schedule_dates.Thursday.morning %}class="available-time" {% if not assigned_encounters.Thursday.morning and not in_progress_encounters.Thursday.morning %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'morning')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '3', 'morning')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Thursday.morning %}                                                    
                                                    {% if in_progress_encounters.Thursday.morning %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Thursday.morning %}
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Thursday.morning %}
                                                        {% for encounter in assigned_encounters.Thursday.morning %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                    
                                                {% endif %}                                                
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Friday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Friday.is_future %}{% if schedule_dates.Friday.morning %}class="available-time" {% if not assigned_encounters.Friday.morning and not in_progress_encounters.Friday.morning %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'morning')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '4', 'morning')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Friday.morning %}                                                    
                                                    {% if in_progress_encounters.Friday.morning %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Friday.morning %}
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Friday.morning %}
                                                        {% for encounter in assigned_encounters.Friday.morning %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                    
                                                {% endif %}                                                
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Saturday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Saturday.is_future %}{% if schedule_dates.Saturday.morning %}class="available-time" {% if not assigned_encounters.Saturday.morning and not in_progress_encounters.Saturday.morning %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'morning')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '5', 'morning')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Saturday.morning %}
                                                    {% if in_progress_encounters.Saturday.morning %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Saturday.morning %}
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Saturday.morning %}
                                                        {% for encounter in assigned_encounters.Saturday.morning %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                    
                                                {% endif %}                                                
                                            </td>
                                            {% endwith %}
                                        </tr>
                                        <tr>
                                            {% with days_of_week.Monday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Monday.is_future %}{% if schedule_dates.Monday.afternoon %}class="available-time" {% if not assigned_encounters.Monday.afternoon and not in_progress_encounters.Monday.afternoon %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'afternoon')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '0', 'afternoon')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Monday.afternoon %}
                                                    {% if in_progress_encounters.Monday.afternoon %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Monday.afternoon %}
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Monday.afternoon %}
                                                        {% for encounter in assigned_encounters.Monday.afternoon %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                    
                                                {% endif %}                                                
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Tuesday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Tuesday.is_future %}{% if schedule_dates.Tuesday.afternoon %}class="available-time" {% if not assigned_encounters.Tuesday.afternoon and not in_progress_encounters.Tuesday.afternoon %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'afternoon')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '1', 'afternoon')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Tuesday.afternoon %}
                                                    {% if in_progress_encounters.Tuesday.afternoon %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Tuesday.afternoon %}
                                                            <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}                                                
                                                    {% if assigned_encounters.Tuesday.afternoon %}                                 
                                                        {% for encounter in assigned_encounters.Tuesday.afternoon %}
                                                        <form action="" method="POST">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                            <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                        </form>
                                                        {% endfor %}
                                                    {% endif %}                                                    
                                                {% endif %}                                                                                       
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Wednesday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Wednesday.is_future %}{% if schedule_dates.Wednesday.afternoon %}class="available-time" {% if not assigned_encounters.Wednesday.afternoon and not in_progress_encounters.Wednesday.afternoon %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'afternoon')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '2', 'afternoon')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Wednesday.afternoon %}
                                                    {% if in_progress_encounters.Wednesday.afternoon %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Wednesday.afternoon %}                                                            
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Wednesday.afternoon %}                             
                                                        {% for encounter in assigned_encounters.Wednesday.afternoon %}
                                                        <form action="" method="POST">
                                                            {% csrf_token %}
                                                            <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                            <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                        </form>
                                                        {% endfor %}
                                                    {% endif %}                                                     
                                                {% endif %}                                                                                       
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Thursday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Thursday.is_future %}{% if schedule_dates.Thursday.afternoon %}class="available-time" {% if not assigned_encounters.Thursday.afternoon and not in_progress_encounters.Thursday.afternoon %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'afternoon')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '3', 'afternoon')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Thursday.afternoon %}
                                                    {% if in_progress_encounters.Thursday.afternoon %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Thursday.afternoon %}
                                                        <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Thursday.afternoon %}
                                                        {% for encounter in assigned_encounters.Thursday.afternoon %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                       
                                                {% endif %}                                                                                       
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Friday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Friday.is_future %}{% if schedule_dates.Friday.afternoon %}class="available-time" {% if not assigned_encounters.Friday.afternoon and not in_progress_encounters.Friday.afternoon %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'afternoon')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '4', 'afternoon')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Friday.afternoon %}
                                                    {% if in_progress_encounters.Friday.afternoon %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Friday.afternoon %}
                                                            <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Friday.afternoon %}
                                                        {% for encounter in assigned_encounters.Friday.afternoon %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                       
                                                {% endif %}                                                                                       
                                            </td>
                                            {% endwith %}
                                            {% with days_of_week.Saturday.date|date:'Y-m-d' as date_to_submit %}
                                            <td {% if days_of_week.Saturday.is_future %}{% if schedule_dates.Saturday.afternoon %}class="available-time" {% if not assigned_encounters.Saturday.afternoon and not in_progress_encounters.Saturday.afternoon %} onclick="changeDisplay('delete-form', '{{date_to_submit}}', 'afternoon')" {% endif %}{% else %}class="not-available-time"  onclick="changeDisplay('form-container', '5', 'afternoon')" {% endif %} {% endif %}>
                                                {% if schedule_dates.Saturday.afternoon %}
                                                    {% if in_progress_encounters.Saturday.afternoon %}
                                                        <p>Danh sách bệnh nhân</p>
                                                        {% for encounter in in_progress_encounters.Saturday.afternoon %}
                                                            <p><a href="{% url 'fhir:hanhchinh' encounter.assigned_encounter.patient.identifier encounter.assigned_encounter.encounter_identifier %}">{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - Đang khám</a></p>
                                                        {% endfor %}
                                                    {% endif %}
                                                    {% if assigned_encounters.Saturday.afternoon %}
                                                        {% for encounter in assigned_encounters.Saturday.afternoon %}
                                                            <form action="" method="POST">
                                                                {% csrf_token %}
                                                                <input type="hidden" name="encounter_identifier" value="{{encounter.assigned_encounter.encounter_identifier}}">
                                                                <p>{{encounter.assigned_encounter.patient.name}} - {{encounter.assigned_encounter.patient.identifier}} - <input type="submit" class="btn" value="Tiếp nhận"></p>
                                                            </form>
                                                        {% endfor %}
                                                    {% endif %}                                                       
                                                {% endif %}                                                                                       
                                            </td>
                                            {% endwith %}
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                    </tbody>
                </table>
            </div>  
        </div>        
    </div>
    <div class="form-container" id="form-container" style="display: none;">
        <form id="form" action="" method="post">
            {% csrf_token %}
            <div class="form-header">
                <i class="fas fa-grip-lines"></i>
                <i onclick="changeDisplay('form-container')" class="fas fa-times"></i>
            </div>
            <div class="form-body">
                <label for="day_of_work">Ngày làm việc:</label>
                <select name="day_of_work" id="day_of_work">
                    {% if days_of_week.Monday.is_future %}
                        <option value="0">Thứ Hai</option>
                    {% endif %}
                    {% if days_of_week.Tuesday.is_future %}
                        <option value="1">Thứ Ba</option>
                    {% endif %}
                    {% if days_of_week.Wednesday.is_future %}
                        <option value="2">Thứ Tư</option>
                    {% endif %}
                    {% if days_of_week.Thursday.is_future %}}
                        <option value="3">Thứ Năm</option>
                    {% endif %}
                    {% if days_of_week.Friday.is_future %}
                        <option value="4">Thứ Sáu</option>
                    {% endif %}
                    {% if days_of_week.Saturday.is_future %}
                        <option value="5">Thứ Bảy</option>
                    {% endif %}
                </select>
                <br>
                <label for="session">Buổi:</label>
                <select name="session" id="session">
                    <option value="morning">Sáng</option>
                    <option value="afternoon">Chiều</option>
                </select>
                <br>
                <button class="btn" style="display: block; margin: 0 auto;">Thêm</button>
            </div>
        </form>
    </div>
    <div class="form-container" id="delete-form" style="display: none;">
        <form action="{% url 'fhir:delete' %}" method="post">
            <div class="form-header">
                <i class="fas fa-grip-lines"></i>
                <i onclick="changeDisplay('delete-form')" class="fas fa-times"></i>
            </div>
            {% csrf_token %}
            <div class="form-body">
                <p style="text-align: center;" id="confirmation-text"></p>
                <input type="hidden" name="resource_type" id="resource_type" value="schedule_value">
                <input type="hidden" name="practitioner_identifier" id="practitioner_identifier" value={{request.user.username}}>
                <input type="hidden" name="delete_date" id="delete_date" value="">
                <input type="hidden" name="delete_session" id="delete_session" value="">
                <input type="hidden" name="url_next" value="{{request.path}}">
                <button class="btn" style="display: block; margin: 0 auto">Xóa</button>
            </div>
        </form>
    </div>
    <script>
        session = {
            "morning": "sáng",
            "afternoon": "chiều"
        }
        week = {
            "0": "Thứ Hai",
            "1": "Thứ Ba",
            "2": "Thứ Tư",
            "3": "Thứ Năm",
            "4": "Thứ Sáu",
            "5": "Thứ Bảy"
        }
        function changeDisplay(elementId, weekDay, sessionValue){
            element = document.getElementById(elementId);
            if (elementId == "form-container"){
                dayElement = document.getElementById("day_of_work");
                sessionElement = document.getElementById("session");
                //startTime = document.getElementById("start_time");
                //endTime = document.getElementById("end_time");
                if (element.style.display == "none"){
                    element.style.display = "flex";
                    dayElement.value = weekDay;
                    sessionElement.value = sessionValue;
                //    if (sessionValue == "morning"){
                //        startTime.setAttribute("min", "07:00");
                //      startTime.setAttribute("max", "12:00");
                //      endTime.setAttribute("min", "07:00");
                //     endTime.setAttribute("max", "12:00");
                //      startTime.value = "07:00";
                //     endTime.value = "12:00";
                //  }else if (sessionValue == "afternoon"){
                //     startTime.setAttribute("min", "13:00");
                    //    startTime.setAttribute("max", "17:00");
                    //    endTime.setAttribute("min", "13:00");
                    //    endTime.setAttribute("max", "17:00");
                    //    startTime.value = "13:00";
                    //    endTime.value = "17:00";
                // }
                }
                else {
                    element.style.display = "none";
                }
            }
            else if (elementId == "delete-form"){

                if (element.style.display == "none"){
                    element.style.display = "flex";
                    text = document.getElementById("confirmation-text")
                    document.getElementById('delete_date').value = weekDay;
                    document.getElementById('delete_session').value = sessionValue;
                    text.innerHTML = "Bạn muốn thay đổi lịch khám ?";
                }
                else {
                    element.style.display = "none";
                }
            }
        }
        
        var watchClickOnMeElement = document.getElementById('form-container');
    
        document.addEventListener('click', function(event) {
            if (event.target == watchClickOnMeElement) {
                watchClickOnMeElement.style.display = "none";
        }
        });

        var deleteForm = document.getElementById('delete-form');
        document.addEventListener('click', function(event) {
            if (event.target == deleteForm) {
                deleteForm.style.display = "none";
        }
        });        

        
        function setMinMax(){
            var session = document.getElementById("session");
            var start = document.getElementById("start_time");
            var end = document.getElementById("end_time");
            if (session.options[session.selectedIndex].value == "morning"){
                start.setAttribute("min", "07:00");
                start.setAttribute("max", "12:00");
                end.setAttribute("min", "07:00");
                end.setAttribute("max", "12:00");
                start.value="07:00";
                end.value="12:00";
            }else if (session.options[session.selectedIndex].value == "afternoon"){
                start.setAttribute("min", "13:00");
                start.setAttribute("max", "17:00");
                end.setAttribute("min", "13:00");
                end.setAttribute("max", "17:00");
                start.value="13:00";
                end.value="17:00";
            }
        }
        function timeCheck(){
            start = document.getElementById("start_time");
            console.log(start.value);
            end = document.getElementById("end_time");
            console.log(end.value);
        }
    </script>
{% endblock %}